### 集群规划 

- 独立的master节点，不存储数据，数量不少于2
- 数据节点

- 查询节点，起到负载均衡的作用

### linux系统参数配置

每个进程默认可以打开的最大文件句柄数是1000，修改/etc/security/limits.conf来增加

\* \- nofile 65535

### 虚拟内存设置

修改进程能拥有的最大内存区域

sysctl -w vm.max_map_count=262144

### JVM参数设置

根据服务器配置跳转堆内存

### 分片策略

每个节点同一个index不要超过3个



### 磁盘缓存相关参数

- vm.dirty_background_ratio 当文件系统缓存脏数据大道系统内存百分比就会触发将缓存的数据写入外存，此过程会因为IO阻塞

  sysctl -w vm.dirty_ratio=10

### refresh时间间隔

默认1s刷新一次，在大量写入的场景中，这样配置会导致写入吞吐量很低，适当提高刷新间隔，提升写入量，代价就是数据可见的及时性会有所下降

### 调整线程池，size不要超过CPU核数，否则线程之间会有大量的切换

### 定期清理Cache

避免fields data占用大量的jvm内存，定期清理来释放缓存数据

ip:9200/_cache/clear



### 其他

- marvel:插件，可以观察系统资源占用情况，包括cpu、内存、查询频率等
- 经常查看日志